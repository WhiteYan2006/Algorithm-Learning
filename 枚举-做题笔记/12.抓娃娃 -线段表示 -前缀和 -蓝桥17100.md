---
date: 2025-07-21
tags:
  - 编程
  - 算法
  - 前缀和
  - 线段表示
  - 枚举
  - Cpp
  - 习题
---

- 本题如何描述“至少一半”的条件很重要

# 问题描述

小明拿了 $n$ 条线段练习抓娃娃。他将所有线段铺在数轴上，第 $i$ 条线段的左端点在 $l_i$，右端点在 $r_i$。小明用 $m$ 个区间去框这些线段，第 $i$ 个区间的范围是 $[L_i, R_i]$。如果一个线段有**至少一半**的长度被包含在某个区间内，则将其视为被这个区间框住。请计算出每个区间框住了多少个线段？

### 输入格式

输入共 $n + m + 1$ 行。

- 第一行为两个正整数 $n, m$。
- 后面 $n$ 行，每行两个整数 $l_i, r_i$。
- 后面 $m$ 行，每行两个整数 $L_i, R_i$。

### 输出格式

输出共 $m$ 行，每行一个整数。

### 样例输入

```
3 2
1 2
1 3
3 4
1 4
2 4
```

### 样例输出

```
3
2
```

### 评测用例规模与约定

- 对于 $20\%$ 的数据，保证 $n, m \leq 10^3$。
- 对于 $100\%$ 的数据，保证 $n, m \leq 10^5$，$l_i < r_i$，$0 < l_i, r_i, L_i, R_i \leq 10^6$，$\max\{r_i - l_i\} \leq \min\{R_i - L_i\}$。

# 实现
## 思路
![[Drawing 2025-07-21 10.55.19.excalidraw]]
- 用**中点**表示是否满足“**至少一半**”
- 把每个娃娃的中点计算出来，然后使用前缀和算法
- 处理小数：因为终点的小数只能是`0.5`，所以可以把所有坐标乘以二

> [!NOTE] 处理**0.5**
> 把坐标乘2，避免复杂的分类讨论，转换成整数处理


## 代码
```C++
#include <bits/stdc++.h>
using namespace std;
int main() {
  long long n, m;
  cin >> n >> m;
  vector<long long> sum(2e6 + 1);//记得+1
  while (n--) {
    long long l, r;
    cin >> l >> r;
    sum[l + r]++;
  }
  partial_sum(sum.begin(), sum.end(), sum.begin());
  while (m--) {
    long long left, right;
    cin >> left >> right;
    cout << sum[right*2] - sum[left*2-1] << endl;
  }
  return 0;
}
```