---
date: 2026-02-13
---

# 31. 近似 gcd lq2209

## 题目链接
https://www.lanqiao.cn/problems/2209/learning/

## 题目描述
给你一个正整数序列 $A$，序列中一共有 $n$ 个数。

对于每个 $A_i$，我们都认为它是一组由 $1\sim A_i$ 组成的集合中的最大值。

如果存在两个数 $x$ 和 $y$，满足：
- $x$ 来自 $1\sim A_i$
- $y$ 来自 $1\sim A_j$
- $gcd(x,y) > m$

则称 $A_i$ 与 $A_j$ 近似。

请你求出满足 $i < j$ 且 $A_i$ 与 $A_j$ 近似的数对数量。

## 输入格式
- 第一行输入两个整数 $n, m$。
- 第二行输入 $n$ 个整数 $A_1, A_2, \dots, A_n$。

## 输出格式
输出一个整数，表示满足条件的数对个数。

## 样例输入
```text
5 2
3 5 4 9 5
```

## 样例输出
```text
4
```

## 数据范围
- $n \le 50000$
- $A_i \le 30000$

# 实现
## 思路
- 把数组中的元素模$g$，不等0的设置为1
- 直接变成简单的单调性枚举，即满足区间内等于1的个数$<2$的区间数
- 记得有一个长达$\geq2$的限制

## 代码
```Cpp
#include <bits/stdc++.h>
using namespace std;
int main() {
  int n, g;
  cin >> n >> g;
  vector<long long> a(n);
  for (auto& x : a) {
    cin >> x;
    x = (x % g != 0);
  }
  long long cnt = 0;
  int sum = 0;
  for (int l = 0, r = 0; l < n - 1;) {
    while (r < n && sum <= 1) {
      sum += a[r++];
    }
    if (sum >= 2) cnt += r - 2 - l + 1 - 1; //注意长度要大于2，有效个数要-1
    else {
      cnt += r - 1 - l + 1 - 1;
    }
    sum -= a[l++];
  }
  cout << cnt << endl;
}
```

## Note
> [!note]
> 本题只需要转化一下就很简单

