---
date: 2025-07-20
tags:
  - 编程
  - 算法
  - 枚举
  - 前缀和
  - 习题
  - Cpp
  - 普遍前缀
---

# 题目
给定 `n` 个非负整数表示每个宽度为 `1` 的柱子的高度图，计算按此排列的柱子，下雨之后能接多少雨水。

**示例 1：**

![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/10/22/rainwatertrap.png)

**输入：height = `[0,1,0,2,1,0,1,3,2,1,2,1]`
**输出：6
**解释：上面是由数组`[0,1,0,2,1,0,1,3,2,1,2,1]` 表示的高度图，在这种情况下，可以接 6 个单位的雨水（蓝色部分表示雨水）。 

**示例 2：**

**输入：height = `[4,2,0,3,2,5]`
**输出：**9

**提示：**

- `n == height.length`
- `1 <= n <= 2 * 104`
- `0 <= height[i] <= 105`

# 实现
## 思路
![[Pasted image 20250720110644.png]]
求左右两边最大值中的最小值，即为该槽的最大容量

## 代码
```C++
class Solution {
 public:
  int trap(vector<int>& height) {
    int n = height.size();
    vector<int> left_max(n), right_max(n);
    for (int i = 0; i < n; i++) {
      if (i == 0)
        left_max[i] = height[i];
      else
        left_max[i] = max(left_max[i - 1], height[i]);
    }
    for (int i = n - 1; i >= 0; i--) {
      if (i == n - 1)
        right_max[i] = height[i];
      else
        right_max[i] = max(right_max[i + 1], height[i]);
    }
    // partial_sum(h.begin(), h.end(), left_max.begin(), [&](int prev, int cur) {
    //   return max(prev, cur);
    // });
    // partial_sum(h.rbegin(), h.rend(), right_max.rbegin(), [&](int prev, int cur) {
    //   return max(prev, cur);
    // });
    int sum = 0;
    for (int i = 1; i < n-1; i++) {
      sum += max(0, min(left_max[i-1], right_max[i+1]) - height[i]); //防止负数
    }
    return sum;
  }
};
```